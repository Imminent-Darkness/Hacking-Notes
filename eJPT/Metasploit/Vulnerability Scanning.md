# Vulnerability Scanning

* [General Information](#general-information)
* [Metasploit Autopwn](#metasploit-autopwn)
* [Nmap in MSF](#nmap-in-msf)
* [Import Nessus into MSF](#import-nessus-into-msf)
* [WMAP](#wmap)
* [References](#references)

***********************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
***********************************************************************

## General Information

Check for vulnerabilities inside msfconsole:
```
analyze
```
```
vulns
```

Ensure postgresql service is running:
```
service postgresql start
```
```
service postgresql status
```

***********************************************************************

## Metasploit Autopwn

Github:   
https://github.com/hahwul/metasploit-autopwn
```
wget https://raw.githubusercontent.com/hahwul/metasploit-autopwn/master/db_autopwn.rb
```
```
sudo mv db_autopwn.rb /usr/share/metasploit-framework/plugins/
```

Inside msfconsole:
```
load db_autopwn
```

Documentation:
```
db_autopwn
```

Check for all matching modules:
```
db_autopwn -p -t
```

Check for matching modules based on port:
```
db_autopwn -p -t -PI [PORT]
```

***********************************************************************
## Nmap in MSF

Output Nmap Scan in XML:
```
Nmap [SCAN-OPTIONS] -oX [OUTFILE] 
```

### Import Nmap into MSF

Create a new workspace:
```
workspace -a [NAME]
```

Import:
```
db_import [PATH-TO-FILE]
```

Confirm successful import:
```
hosts
```
```
services
```

### Perform Nmap Scan within MSF

```
db_nmap [USE-NORMAL-NMAP-COMMAND-OPTIONS]
```
* The output is saved to MSF automatically  


***********************************************************************

## Import Nessus into MSF

Create a new workspace:
```
workspace -a [NAME]
```

Import:
```
db_import [PATH-TO-FILE]
```

Confirm successful import:
```
hosts
```
```
services
```

***********************************************************************

## WMAP
* Web Vulnerability Scanner  

Load wmap module in msfconsole:
```
load wmap
```

Add a new site:
```
wmap_sites -a [TARGET-IP]
```

Specify target URL:
```
wmap_targets -t [URL]
```

List sites & targets:
```
wmap_sites -l
```
```
wmap_targets -l
```

Show what wmap will be scanning for:
```
wmap_run -t
```

Run vulnerability scan:
```
wmap_run -e
```

List vulnerabilities that wmap was able to detect:
```
wmap_vulns -l
```

***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2