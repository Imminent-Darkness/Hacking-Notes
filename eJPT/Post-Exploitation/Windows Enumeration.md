# Windows Enumeration

* [Enumerating System Information](#enumerating-system-information)
* [Enumerating Users & Groups](#enumerating-users--groups)
* [Enumerating Network Information](#enumerating-network-information)
* [Enumerating Processes & Services](#enumerating-processes--services)
* [Automating Windows Enumeration](#automating-windows-enumeration)
* [References](#references)

******************************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
******************************************************************************

## Enumerating System Information

What are we looking for?

* Hostname
* OS Name (Windows 7, 8, 10, etc)
* OS Build & SErvice Pack (Windows 7 SP1 7600)
* OS Architecture (x86/x64)
* Installed updates/Hotfixes

### Windows commands:
```
systeminfo
```
```
wmic qfe get Caption,Description,HotFixID,InstalledOn
```
```
more C:\Windows\System32\eula.txt
```

***********************************************************************

## Enumerating Users & Groups

What are we looking for?

* Current users & privileges
* Additional user information
* Other users on the system
* Groups
* Members of the built-in administrator group

### Meterpreter Commands:

```
getuid
```
```
getprivs
```  
  
msfconsole modules:
```
use post/windows/gather/enum_logged_on_users
```  
  
### Windows Commands:

```
whoami /priv
```

Check currently logged on users:
```
query user
```

Display all users on system:
```
net users
```

List info on specific user account:
```
net user [USERNAME]
```

Display all groups on the system:
```
net localgroup
```

Check to see what users belong to a given group:
```
net localgroup [GROUP]
```

***********************************************************************

## Enumerating Network Information

What are we looking for?

* Current IP address & network adapter
* Internal networks
* TCP/UDP services running and their respective ports
* Other hosts on the network
* Routing table
* Windows Firewall state

### Windows Commands

```
ipconfig
```
```
ipconfig /all
```
```
route print
```
```
arp -a
```
```
netstat -ano
```
```
netsh firewall show state
```
OR:
```
netsh advfirewall firewall show
```

***********************************************************************

## Enumerating Processes & Services

What are we looking for?

* Running processes & services
* Scheduled Tasks

*A process is a running executable (.exe) or program*  
*A service is a process that runs in the background and does not interact with the desktop*

### Meterpreter Commands:

```
ps
```
```
pgrep [PROCESS]
```
```
migrate [PID]
```

### Windows Commands

```
net start
```
```
wmic service list brief
```
```
tasklist /SVC
```
```
schtasks /query /fo LIST /v
```
*WARNING: schtasks will produce a lot of output*  

***********************************************************************

## Automating Windows Enumeration

### JAWS - Just Another Windows (Enum) Script
* GitHub:
   * https://github.com/411Hall/JAWS  
  
Transfer JAWS to target machine; consider the Temp directory:

```
powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename [OUT-FILE]
```
*This script takes time to run; it may also produce errors when running certain parts of the script, this is fine*

### msfconsole modules

```
post/windows/gather/win_privs
```
```
post/windows/gather/checkvm
```
```
post/windows/gather/enum_applications
```
```
post/windows/gather/enum_computer
```
```
post/windows/gather/enum_patches
```
```
post/windows/gather/enum_shares
```

***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2