# Pivoting

******************************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
******************************************************************************

## Port Forwarding

* Port forwarding is the process of redirecting traffic from a specific port on a target system to a specific port on our system.  
  
* In the context of pivoting, we can forward a remote port on a previously inaccessible host toa local port on our Kali Linux system so that we can remotely interact/exploit the service running on the port.  
  
## From meterpreter shell on Target 1:

```
ifconfig
```
*Note IPv4 Netmask*  
  
Now set up a route to the internal network:
```
run autoroute -s [NETWORK-IP]/[CIDR]
```
Example:
```
run autoroute -s 10.0.29.0/20
```  
  
Show routing table:
```
run autoroute -p
```   
   
background meterpreter session and use portscan module:

```
use auxiliary/scanner/portscan/txp
```
```
set RHOSTS [TARGET-2-IP]
```
```
set PORTS [#-#]
```
```
run
```

### Now we need to use nmap on target 2...

Go back to Target 1's meterpreter session:
```
sessions 1
```  
  
Now turn on port forwarding:
```
portfwd add -l [LPORT] -p [OPEN-PORT-ON-TARGET-2] -r [TARGET-2-IP]
```   
   
From Attack Machine we can run nmap:
```
nmap -sV -p [LPORT-SPECIFIED-IN-PREVIOUS-STEP] localhost
```

* now use applicable module in msfconsole
* set RHOSTS to Target 2's IP
* set another required options and exploit

***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2