# Cracking Hashes

******************************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
******************************************************************************

unzip rockyou.txt:
```
gzip -d /usr/share/wordlists/rockyou.txt.gz
```

## John The Ripper

```
john --format=[FORMAT] [HASH-FILE] --wordlist=[WORDLIST]
```

NTLM Hash (Windows) Example:
```
john --format=NT hashes.txt --wordlist=/usr/share/wordlist/rockyou.txt
```

sha512crypt(Linux) example:
```
john --format=sha512crypt hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

## Hashcat

```
hashcat -a3 -m [HASH-TYPE-CODE] [HASH-FILE] [WORDLIST]
```

NTLM Hash (Windows) Example:
```
hashcat -a3 -m 1000 hashes.txt /usr/share/wordlists/rockyou.txt
```

sha512crypt (Linux) Example:
```
hashcat -a3 -m 1800 hashes.txt /usr/share/wordlists/rockyou.txt
```

## Example Hash Files:

NTLM:
```
Administrator:500:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::
bob:1009:aad3b435b51404eeaad3b435b51404ee:5835048ce94ad0564e29a924a03510ef:::
```

Linux Needs to Be 'unshadowed':

in msfconsole:
```
use /post/linux/gather/hashdump
```
Unshadowed example:
```
root:$6$sgewtGbw$ihhoUYASuXTh7Dmw0adpC7a3fBGkf9hkOQCffBQRMIF8/0w6g/Mh4jMWJ0yEFiZyqVQhZ4.vuS8XOyq.hLQBb.:0:0:root:/root:/bin/bash
```

### Linux Hash Algorithms

* $1 = MD5
* $2 = Blowfish
* $5 = SHA-256
* $6 = SHA-512


***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2
