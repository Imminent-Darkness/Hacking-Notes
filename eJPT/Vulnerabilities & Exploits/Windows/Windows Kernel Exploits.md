# Windows Kernel Exploits

* [GitHub](#github)
* [Metasploit](#metasploit)
* [Windows Exploit Suggestor](#windows-exploit-suggester)
* [References](#references)

***********************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
***********************************************************************

## GitHub 
https://github.com/SecWiki/windows-kernel-exploits  
https://github.com/AonCyberLabs/Windows-Exploit-Suggester 

***********************************************************************

## Metasploit
To attempt to escalate privileges in meterpreter automatically:
```
getsystem
```
To search for vulnerabilities:
```
search suggester
```
```
use post/multi/recon/local_exploit_suggester
```
```
set session [SESSION-ID]
```
Now research the suggested vulnerabilities and choose a module to exploit the target.  

To transfer files via meterpreter:
```
upload [FILE-PATH]
```

***********************************************************************

## Windows Exploit Suggester
Github:   
https://github.com/AonCyberLabs/Windows-Exploit-Suggester   

On an un-elevated shell on target system:
```
systeminfo
```
* Copy all the systeminfo output and put it in a file on the attack machine  
* cd into the directory containing Windows Exploit Suggester
* Make sure the database is updated first:
```
./windows-exploit-suggester.py --update
```
* Now execute Windows Exploit Suggester
```
./windows-exploit-suggester.py --database [MOST-UP-TO-DATE-DATABASE.xls] --systeminfo [PATH-TO-SYSTEMINFO-FILE]
```
[E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin   
* Exploits on top of suggested list have the highest chance of success     
* Now research the suggested vulnerabilities and choose one to exploit the target...  

* Good source of exploit code:  
https://github.com/SecWiki/windows-kernel-exploits   

Now download the applicable exploit code, transfer it to target machine, and execute the code to escalate privileges...

To transfer files via meterpreter:
```
upload [FILE-PATH]
```

***********************************************************************

### References
Penetration Tester Student v2 by INE  
https://my.ine.com/CyberSecurity/learning-paths/61f88d91-79ff-4d8f-af68-873883dbbd8c/penetration-testing-student-v2
