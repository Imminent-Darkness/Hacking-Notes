# 2.0 Information Gathering and Vulnerability Scanning

* [Zone Transfer](#zone-transfer)
* [sslscan](#sslscan)
* [metagoofil](#metagoofil) 
* [exif](#exif)
* [Enumeration](#enumeration) 
* [recon ng](#recon-ng)
* [nmap](#nmap)
* [Packet Crafting](#packet-crafting) 
* [Packet Sniffing](#packet-sniffing)
* [Proxies](#proxies)
* [Web Scrapers](#web-scrapers)
* [Directory Fuzzing](#directory-fuzzing)
* [Cloud Enumeration](#cloud-enumeration)
* [Web Application Firewall Detection](#web-application-firewall-detection)
* [Firewalking](#firewalking)
* [Anti Virus Detection](#anti-virus-detection)
* [Vulnerability Scanners](#vulnerability-scanners)
* [Source Code Repositories](#source-code-repositories)
* [Hosts](#hosts)
* [Load Balance Detection](#load-balance-detection)
* [Other](#other)
* [Resources](#resources)
* [References](#references)

*********************************************************************************
Items inside [SQUARE-BRACKETS] indicate changeable (fill in the blank) fields.  
Note: Bracket characters themselves [ ] require removal. See examples.
*********************************************************************************

## Zone Transfer
```
dig axfr @[NAME-SERVER] [DOMAIN] 
```
Example:
```
dig axfr @nsztml.gigi.nija zonetransfer.me 
```
More ways:
```
host -t axfr [DOMAIN-NAME] [DNS-SERVER]
```
```
nmap -script dns-zone-transfer.nse -script-args dns-zone-transfer.domain[DOMAIN] -p53 [HOSTS]
```
* Practice:
   * https://digi.ninja/projects/zonetransferme.php 

## sslscan 
(check website for insecure ssl implementations)
```
sslscan [DOMAIN]
```

## metagoofil 
(download files from websites)
```
metagoofil -d [DOMAIN] -t [FILE-TYPES,COMMA-SEPERATED] -e [WAIT-TIME-MS] -w
```
Example:
```
metagoofil -d KyserClark.com -t pdf,txt,xml,doc,docx,xls -e 200 -w
```

## exif 
(view file meta data)
```
exif [FILE]
```
```
exiftool [FILE]
```

## Enumeration
* theHarvester (get info from websites)
   ```
   theHarvester --dns-brute -d [DOMAIN]
   ```
* metasploit
  ```
  use auxiliary/gather/search_email_collector
  ```
  ```
  set domain [TARGET-DOMAIN]
  ```
  ```
  set outfile [OUTPUT-FILE]
  ```
  ```
  exploit
  ```
* snmpwalk
   ```
   snmpwalk public -v1 [IP-ADDRESS]
   ```
* samrdump
   * https://github.com/SecureAuthCorp/impacket/blob/impacket_0_9_15/examples/samrdump.py


## recon ng
```
recon-ng
```

## nmap
https://github.com/KyserClark/Hacking-Notes/tree/main/Nmap
* Zenmap (GUI nmap)

## Packet Crafting
* Tools
   * Scapy (interactive packet manipulation tool)
      ```
      man scapy
      ```
    * Hping / Hping3
      ```
      hping -S -V [TARGET] -p [PORT]
      ```
      Example:
      ```
      hping -S -V KyserClark.com -p 8080
      ```
    * Yersinia
    * Netcat

## Packet Sniffing
* Wireshark
* tshark
* tcpdump
* Kismet

## Proxies
* OWASP Zed Attack Proxy 
   * (ZAP)
* BurpSuite

## Web Scrapers
* Beautiful Soup

## Directory Fuzzing
* DirBuster
* GoBuster
```
gobuster dir -u [TARGET] -w [WORDLIST]
```
Example:
```
gobuster dir -u http://192.168.241.143 -w /usr/share/wordlist/dirb/common.txt
```
* Dirb
```
dirb [TARGET] [WORDLIST]
```
Example: 
```
dirb http://192.168.241.143 /usr/share/wordlist/dirb/common.txt
```

## Cloud Enumeration
* cloud_enum
```
cloud_enum --help
```

## Web Application Firewall Detection 
* wafw00f (web application firewall fingerprinting toolkit)
   ```
   wafw00f [URL] [URL2] [URL3...]
   ```
* WhatWaf
* nmap --script=http-waf-detect.nse [DOMAIN]

## Firewalking
* firewalk
* nmap firewalk.nse script

## Anti Virus Detection
* BeEF (Browser Exploitation Framework)
   *  provides antivirus (AV) detection modules once system access is gained
* EICAR

## Vulnerability Scanners
* Nessus
* OpenVAS
* Acunetix
* Nikto

## Source Code Repositories
* CloudFormation
* Ansible
* Puppet
* Chef
* SaltStack

## Hosts
* Central Management Systems
   * Microsoft's Endpoint Configuration Manager
   * Jamf Pro
* Logs
   * DHCP
   * ARP tables  

## Load Balance Detection
* Tools
   * lbd

## Other
* Banner Grabbing
* Wardriving
* SNMP Sweeps
* Tools
   * pwnedOrNot 

****************************************************
## Resources

* https://www.exploit-db.com/google-hacking-database
* https://archive.org/web/
* https://www.shodan.io/
* https://cwe.mitre.org/
* https://cve.mitre.org/
* https://www.bgp4.as/looking-glasses
* https://osintcurio.us/2019/01/15/tracking-all-the-wifi-things/
* https://www.shodan.io/
* https://search.censys.io/
* https://www.zoomeye.org/
* https://hunter.io/
* https://haveibeenpwned.com/
* https://owasp.org/www-pdf-archive/OWASP_Stammtisch_Frankfurt_WAF_Profiling_and_Evasion.pdf
* https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/
* https://www.secureauth.com/labs/open-source-tools/impacket/

****************************************************
### References
* https://www.itpro.tv/courses/comptia/comptia-pentest-pt0002/
* Chapple, M., & Seidl, D. (2022). CompTIA PenTest+ Study Guide: Exam PT0-002 (2nd ed.). Sybex. (Chapter 3)
